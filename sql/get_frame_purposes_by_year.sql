SELECT SUBSTR(ID, 9, 4) as year, COUNT(DISTINCT ID) as count, FramePurpose FROM `gcp-cset-projects.rhetorical_frames.paragraph_level_latest` WHERE FramePurpose != "" AND ID LIKE "FRNA%" GROUP BY year, FramePurpose order by year
SELECT SUBSTR(ID, 9, 4) as year, COUNT(DISTINCT ID) as count, FramePurpose FROM `gcp-cset-projects.rhetorical_frames.paragraph_level_latest` WHERE FramePurpose != "" AND ID LIKE "LBA%" GROUP BY year, FramePurpose order by year
SELECT REGEXP_EXTRACT(Source_Link, "20[0-9][0-9]") as year, COUNT(distinct ID) as count, FramePurpose FROM `gcp-cset-projects.rhetorical_frames.paragraph_level_latest` as par INNER JOIN (SELECT Source_Link, ID_Name FROM `gcp-cset-projects.defenseone_check_tmp.defenseone_file_list`) as list on par.ID = list.ID_Name WHERE ID LIKE "Defense%" and FramePurpose != "" GROUP BY FramePurpose, year order by year